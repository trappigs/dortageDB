@model IEnumerable<dortageDB.Entities.EgitimVideo>

@{
    ViewData["Title"] = "Eğitim Videoları Yönetimi";
    Layout = "_LayoutTopraktar";
}

<link rel="stylesheet" href="~/css/admin-panel.css" asp-append-version="true" />

<style>
    .video-thumbnail {
        width: 120px;
        height: 70px;
        object-fit: cover;
        border-radius: 8px;
    }

    .badge {
        padding: 4px 12px;
        border-radius: 6px;
        font-size: 12px;
        font-weight: 600;
    }

    .badge-active {
        background: #d1fae5;
        color: #065f46;
    }

    .badge-inactive {
        background: #fee2e2;
        color: #991b1b;
    }

    .badge-featured {
        background: #FFC107;
        color: #000a68;
    }

    .badge-new {
        background: #10b981;
        color: white;
    }

    .badge-popular {
        background: #3b82f6;
        color: white;
    }

    .video-actions {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
    }

    .btn-icon {
        padding: 6px 12px;
        font-size: 13px;
    }

    .stats-badge {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 4px 10px;
        background: #f3f4f6;
        border-radius: 6px;
        font-size: 13px;
        color: #6b7280;
    }
</style>

<div style="margin-left: 125px;" class="admin-panel">
    <div class="panel-header">
        <div>
            <h1 class="panel-title">📚 Eğitim Videoları Yönetimi</h1>
            <p class="panel-subtitle">YouTube videolarını yönetin</p>
        </div>
        <a asp-action="CreateVideo" class="btn btn-primary">
            <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
            Yeni Video Ekle
        </a>
    </div>

    @if (TempData["SuccessMessage"] != null)
    {
        <div class="alert alert-success">@TempData["SuccessMessage"]</div>
    }

    <div class="panel-content">
        @if (Model.Any())
        {
            <div class="table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Önizleme</th>
                            <th>Başlık</th>
                            <th>Kategori</th>
                            <th>Süre</th>
                            <th>İstatistikler</th>
                            <th>Etiketler</th>
                            <th>Durum</th>
                            <th>Sıra</th>
                            <th>İşlemler</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var video in Model)
                        {
                            <tr>
                                <td>
                                    <img src="https://img.youtube.com/vi/@video.YoutubeVideoID/mqdefault.jpg"
                                         alt="@video.Baslik"
                                         class="video-thumbnail" />
                                </td>
                                <td>
                                    <div style="max-width: 300px;">
                                        <strong>@video.Baslik</strong>
                                        <div style="font-size: 13px; color: #6b7280; margin-top: 4px;">
                                            @video.Aciklama
                                        </div>
                                    </div>
                                </td>
                                <td>
                                    @{
                                        var kategoriAdi = dortageDB.Entities.EgitimKategorileri.GetAll()
                                            .FirstOrDefault(k => k.Key == video.Kategori).Value ?? video.Kategori;
                                    }
                                    <span class="badge" style="background: rgba(0, 10, 104, 0.1); color: #000a68;">
                                        @kategoriAdi
                                    </span>
                                </td>
                                <td>
                                    <span class="stats-badge">
                                        <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <circle cx="12" cy="12" r="10"></circle>
                                            <polyline points="12 6 12 12 16 14"></polyline>
                                        </svg>
                                        @video.Sure
                                    </span>
                                </td>
                                <td>
                                    <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                                        <span class="stats-badge">
                                            <svg width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                                <circle cx="12" cy="12" r="3"></circle>
                                            </svg>
                                            @video.IzlenmeSayisi
                                        </span>
                                        <span class="stats-badge">
                                            <svg width="14" height="14" fill="currentColor" viewBox="0 0 24 24">
                                                <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"></path>
                                            </svg>
                                            @video.BegeniSayisi
                                        </span>
                                    </div>
                                </td>
                                <td>
                                    <div style="display: flex; gap: 4px; flex-wrap: wrap;">
                                        @if (video.OneEikan)
                                        {
                                            <span class="badge badge-featured">⭐ Öne Çıkan</span>
                                        }
                                        @if (video.Yeni)
                                        {
                                            <span class="badge badge-new">Yeni</span>
                                        }
                                        @if (video.Populer)
                                        {
                                            <span class="badge badge-popular">Popüler</span>
                                        }
                                    </div>
                                </td>
                                <td>
                                    <span class="badge @(video.Aktif ? "badge-active" : "badge-inactive")">
                                        @(video.Aktif ? "Aktif" : "Pasif")
                                    </span>
                                </td>
                                <td>
                                    <strong>@video.Sira</strong>
                                </td>
                                <td>
                                    <div class="video-actions">
                                        <a asp-action="VideoDetails" asp-route-id="@video.VideoID" class="btn btn-sm btn-info btn-icon" title="Detaylar">
                                            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                                <circle cx="12" cy="12" r="3"></circle>
                                            </svg>
                                        </a>
                                        <a asp-action="EditVideo" asp-route-id="@video.VideoID" class="btn btn-sm btn-warning btn-icon" title="Düzenle">
                                            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                            </svg>
                                        </a>
                                        <form asp-action="ToggleVideoAktif" asp-route-id="@video.VideoID" method="post" style="display: inline;">
                                            @Html.AntiForgeryToken()
                                            <button type="submit" class="btn btn-sm @(video.Aktif ? "btn-secondary" : "btn-success") btn-icon" title="@(video.Aktif ? "Pasif Yap" : "Aktif Yap")">
                                                @if (video.Aktif)
                                                {
                                                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path d="M10 9v6m4-6v6m7-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                                    </svg>
                                                }
                                                else
                                                {
                                                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"></path>
                                                        <path d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                                    </svg>
                                                }
                                            </button>
                                        </form>
                                        <a asp-action="DeleteVideo" asp-route-id="@video.VideoID" class="btn btn-sm btn-danger btn-icon" title="Sil">
                                            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <polyline points="3 6 5 6 21 6"></polyline>
                                                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                                            </svg>
                                        </a>
                                    </div>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        }
        else
        {
            <div class="empty-state">
                <div class="empty-icon">📹</div>
                <h3>Henüz video eklenmemiş</h3>
                <p>İlk eğitim videonuzu ekleyerek başlayın</p>
                <a asp-action="CreateVideo" class="btn btn-primary">
                    <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    Yeni Video Ekle
                </a>
            </div>
        }
    </div>
</div>
