@model dortageDB.ViewModels.RegisterVM
@{
    ViewData["Title"] = "Kayıt Ol";
    Layout = "_Layout";
}

<link rel="stylesheet" href="~/css/register-form.css" asp-append-version="true" />

<div class="register-form">
    <div class="container">
        <!-- Sol taraf -->
        <div class="left-section">
            <div class="logo">VEKARER</div>
            <h1 class="headline">Vekarer Ailesine Katıl</h1>
            <p class="subheadline">2 dakikada üye ol, hemen kazanmaya başla</p>

            <div class="benefits">
                <div class="benefit-item">
                    <div class="benefit-icon"></div>
                    <div class="benefit-content">
                        <h4>Ücretsiz Üyelik</h4>
                        <p>Hiçbir ücret ödemeden başla</p>
                    </div>
                </div>
                <div class="benefit-item">
                    <div class="benefit-icon"></div>
                    <div class="benefit-content">
                        <h4>Hızlı Onay</h4>
                        <p>24 saat içinde hesabın aktif</p>
                    </div>
                </div>
                <div class="benefit-item">
                    <div class="benefit-icon"></div>
                    <div class="benefit-content">
                        <h4>Anında Destek</h4>
                        <p>7/24 yardım hattı</p>
                    </div>
                </div>
                <div class="benefit-item">
                    <div class="benefit-icon"></div>
                    <div class="benefit-content">
                        <h4>Eğitim Materyalleri</h4>
                        <p>Vekarer Akademisi erişimi</p>
                    </div>
                </div>
            </div>

            @* <div class="trust-indicators">
                <div class="trust-item">
                    <div class="trust-number">2000+</div>
                    <div class="trust-label">Aktif Vekarer</div>
                </div>
                <div class="trust-item">
                    <div class="trust-number">500+</div>
                    <div class="trust-label">Başarılı Satış</div>
                </div>
            </div> *@
        </div>

        <!-- Sağ taraf -->
        <div class="right-section">
            <div class="form-container">
                <div class="form-header text-center">
                    <h2>Hesap Oluştur</h2>
                    <p class="mb-1 text-danger fw-bold">SADECE REFERANS KODUYLA ÜYE OLUNABİLİR</p>
                    <p class="mb-3 text-danger fw-bold small">REFERANS KODUNUZ YOKSA LÜTFEN TALEP EDİNİZ</p>
                    
                    <button type="button" class="btn btn-primary btn-lg w-100 mb-4 fw-bold" data-bs-toggle="modal" data-bs-target="#basvuruModal">
                        Referans Kodum Yok
                    </button>
                    
                    <div class="position-relative mb-4">
                        <hr class="text-muted">
                        <span class="position-absolute top-50 start-50 translate-middle bg-white px-3 text-muted small">VEYA</span>
                    </div>

                    <p class="text-center text-primary fw-bold mb-3">REFERANS KODUM VAR</p>
                </div>

                @if (ViewBag.Errors != null)
                {
                    <div class="alert alert-danger">
                        <ul>
                            @foreach (var error in ViewBag.Errors)
                            {
                                <li>@error</li>
                            }
                        </ul>
                    </div>
                }

                <form asp-route="kayit" method="post" id="registrationForm">
                    @Html.AntiForgeryToken()

                    <!-- Hidden fields -->
                    <input type="hidden" asp-for="VekarerMi" value="true" />

                    <div class="form-group">
                        <label asp-for="Code">Referans Kodu <span class="required">*</span></label>
                        <div class="input-wrapper">
                            <svg class="input-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />
                            </svg>
                            <input asp-for="Code" type="text" placeholder="Referans kodunuzu girin" />
                        </div>
                        <div class="error-message" id="referralError" style="display: none;">
                            <span>⚠</span> Referans kodu gereklidir
                        </div>
                        <span asp-validation-for="Code" class="text-danger"></span>
                    </div>

                    <div class="form-row">
                        <div class="form-group half">
                            <label asp-for="Ad">Ad <span class="required">*</span></label>
                            <div class="input-wrapper">
                                <svg class="input-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                </svg>
                                <input asp-for="Ad" type="text" placeholder="Adınız" autocomplete="given-name" />
                            </div>
                            <div class="error-message" id="AdError" style="display: none;">
                                <span>⚠</span> Bu alan zorunludur
                            </div>
                            <span asp-validation-for="Ad" class="text-danger"></span>
                        </div>
                        <div class="form-group half">
                            <label asp-for="Soyad">Soyad <span class="required">*</span></label>
                            <div class="input-wrapper">
                                <svg class="input-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                </svg>
                                <input asp-for="Soyad" type="text" placeholder="Soyadınız" autocomplete="family-name" />
                            </div>
                            <div class="error-message" id="SoyadError" style="display: none;">
                                <span>⚠</span> Bu alan zorunludur
                            </div>
                            <span asp-validation-for="Soyad" class="text-danger"></span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label asp-for="Email">E-posta Adresi <span class="required">*</span></label>
                        <div class="input-wrapper">
                            <svg class="input-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                            </svg>
                            <input asp-for="Email" type="email" placeholder="ornek@email.com" autocomplete="email" />
                            <svg class="validation-icon success" id="emailValidIcon" style="display: none;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                            </svg>
                        </div>
                        <div class="error-message" id="emailError" style="display: none;">
                            <span>⚠</span> Geçerli bir e-posta adresi giriniz
                        </div>
                        <span asp-validation-for="Email" class="text-danger"></span>
                    </div>

                    <div class="form-group">
                        <label asp-for="PhoneNumber">Telefon Numarası <span class="required">*</span></label>
                        <div class="input-wrapper">
                            <svg class="input-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                            </svg>
                            <input asp-for="PhoneNumber" type="tel" placeholder="(5XX) XXX XX XX" autocomplete="tel" />
                        </div>
                        <div class="error-message" id="phoneError" style="display: none;">
                            <span>⚠</span> Geçerli bir telefon numarası giriniz
                        </div>
                        <span asp-validation-for="PhoneNumber" class="text-danger"></span>
                    </div>

                    <div class="form-row">
                        <div class="form-group half">
                            <label asp-for="Cinsiyet">Cinsiyet <span class="required">*</span></label>
                            <div class="input-wrapper">
                                <svg class="input-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                </svg>
                                <select asp-for="Cinsiyet" style="padding-left: 48px;">
                                    <option value="">Cinsiyet seçin</option>
                                    <option value="false">Kadın</option>
                                    <option value="true">Erkek</option>
                                </select>
                            </div>
                            <span asp-validation-for="Cinsiyet" class="text-danger"></span>
                        </div>

                        <div class="form-group half">
                            <label asp-for="Sehir">Şehir <span class="required">*</span></label>
                            <div class="input-wrapper">
                                <svg class="input-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                                </svg>
                                <select asp-for="Sehir" style="padding-left: 48px;" autocomplete="address-level1">
                                    <option value="">Şehir seçin</option>
                                    <option value="Adana">Adana</option>
                                    <option value="Adıyaman">Adıyaman</option>
                                    <option value="Afyonkarahisar">Afyonkarahisar</option>
                                    <option value="Ağrı">Ağrı</option>
                                    <option value="Aksaray">Aksaray</option>
                                    <option value="Amasya">Amasya</option>
                                    <option value="Ankara">Ankara</option>
                                    <option value="Antalya">Antalya</option>
                                    <option value="Ardahan">Ardahan</option>
                                    <option value="Artvin">Artvin</option>
                                    <option value="Aydın">Aydın</option>
                                    <option value="Balıkesir">Balıkesir</option>
                                    <option value="Bartın">Bartın</option>
                                    <option value="Batman">Batman</option>
                                    <option value="Bayburt">Bayburt</option>
                                    <option value="Bilecik">Bilecik</option>
                                    <option value="Bingöl">Bingöl</option>
                                    <option value="Bitlis">Bitlis</option>
                                    <option value="Bolu">Bolu</option>
                                    <option value="Burdur">Burdur</option>
                                    <option value="Bursa">Bursa</option>
                                    <option value="Çanakkale">Çanakkale</option>
                                    <option value="Çankırı">Çankırı</option>
                                    <option value="Çorum">Çorum</option>
                                    <option value="Denizli">Denizli</option>
                                    <option value="Diyarbakır">Diyarbakır</option>
                                    <option value="Düzce">Düzce</option>
                                    <option value="Edirne">Edirne</option>
                                    <option value="Elazığ">Elazığ</option>
                                    <option value="Erzincan">Erzincan</option>
                                    <option value="Erzurum">Erzurum</option>
                                    <option value="Eskişehir">Eskişehir</option>
                                    <option value="Gaziantep">Gaziantep</option>
                                    <option value="Giresun">Giresun</option>
                                    <option value="Gümüşhane">Gümüşhane</option>
                                    <option value="Hakkari">Hakkari</option>
                                    <option value="Hatay">Hatay</option>
                                    <option value="Iğdır">Iğdır</option>
                                    <option value="Isparta">Isparta</option>
                                    <option value="İstanbul">İstanbul</option>
                                    <option value="İzmir">İzmir</option>
                                    <option value="Kahramanmaraş">Kahramanmaraş</option>
                                    <option value="Karabük">Karabük</option>
                                    <option value="Karaman">Karaman</option>
                                    <option value="Kars">Kars</option>
                                    <option value="Kastamonu">Kastamonu</option>
                                    <option value="Kayseri">Kayseri</option>
                                    <option value="Kırıkkale">Kırıkkale</option>
                                    <option value="Kırklareli">Kırklareli</option>
                                    <option value="Kırşehir">Kırşehir</option>
                                    <option value="Kilis">Kilis</option>
                                    <option value="Kocaeli">Kocaeli</option>
                                    <option value="Konya">Konya</option>
                                    <option value="Kütahya">Kütahya</option>
                                    <option value="Malatya">Malatya</option>
                                    <option value="Manisa">Manisa</option>
                                    <option value="Mardin">Mardin</option>
                                    <option value="Mersin">Mersin</option>
                                    <option value="Muğla">Muğla</option>
                                    <option value="Muş">Muş</option>
                                    <option value="Nevşehir">Nevşehir</option>
                                    <option value="Niğde">Niğde</option>
                                    <option value="Ordu">Ordu</option>
                                    <option value="Osmaniye">Osmaniye</option>
                                    <option value="Rize">Rize</option>
                                    <option value="Sakarya">Sakarya</option>
                                    <option value="Samsun">Samsun</option>
                                    <option value="Siirt">Siirt</option>
                                    <option value="Sinop">Sinop</option>
                                    <option value="Sivas">Sivas</option>
                                    <option value="Şanlıurfa">Şanlıurfa</option>
                                    <option value="Şırnak">Şırnak</option>
                                    <option value="Tekirdağ">Tekirdağ</option>
                                    <option value="Tokat">Tokat</option>
                                    <option value="Trabzon">Trabzon</option>
                                    <option value="Tunceli">Tunceli</option>
                                    <option value="Uşak">Uşak</option>
                                    <option value="Van">Van</option>
                                    <option value="Yalova">Yalova</option>
                                    <option value="Yozgat">Yozgat</option>
                                    <option value="Zonguldak">Zonguldak</option>
                                </select>
                            </div>
                            <div class="error-message" id="cityError" style="display: none;">
                                <span>⚠</span> Şehir seçimi zorunludur
                            </div>
                            <span asp-validation-for="Sehir" class="text-danger"></span>
                        </div>
                    </div>

                    <div class="section-divider">
                        <span>Güvenlik Bilgileri</span>
                    </div>

                    <div class="form-group">
                        <label asp-for="Password">Şifre <span class="required">*</span></label>
                        <div class="input-wrapper">
                            <svg class="input-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                            </svg>
                            <input asp-for="Password" type="password" placeholder="En az 8 karakter" autocomplete="new-password" />
                            <svg class="password-toggle" id="passwordToggle" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                            </svg>
                        </div>
                        <div class="password-strength">
                            <div class="password-strength-bar" id="passwordStrengthBar"></div>
                        </div>
                        <div class="password-requirements show">
                            <div class="requirement" id="req-length">
                                <span class="requirement-icon">✓</span>
                                <span>En az 6 karakter</span>
                            </div>
                        </div>
                        <span asp-validation-for="Password" class="text-danger"></span>
                    </div>

                    <div class="form-group">
                        <label asp-for="ConfirmPassword">Şifre Tekrar <span class="required">*</span></label>
                        <div class="input-wrapper">
                            <svg class="input-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z" />
                            </svg>
                            <input asp-for="ConfirmPassword" type="password" placeholder="Şifrenizi tekrar girin" autocomplete="new-password" />
                            <svg class="validation-icon success" id="passwordMatchIcon" style="display: none;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                            </svg>
                        </div>
                        <div class="error-message" id="confirmPasswordError" style="display: none;">
                            <span>⚠</span> Şifreler eşleşmiyor
                        </div>
                        <span asp-validation-for="ConfirmPassword" class="text-danger"></span>
                    </div>

                    <div class="checkbox-group">
                        <div class="checkbox-wrapper">
                            <input asp-for="Pazarlama" type="checkbox" />
                            <label asp-for="Pazarlama" class="checkbox-label">
                                <a href="#" target="_blank">Kullanım Koşulları</a>'nı ve
                                <a href="#" target="_blank">Gizlilik Politikası</a>'nı okudum, kabul ediyorum <span class="required">*</span>
                            </label>
                        </div>
                        <div class="error-message" id="termsError" style="display: none;">
                            <span>⚠</span> Kullanım koşullarını kabul etmelisiniz
                        </div>
                        <span asp-validation-for="Pazarlama" class="text-danger"></span>
                    </div>

                    <div class="checkbox-group">
                        <div class="checkbox-wrapper">
                            <input asp-for="Kvkk" type="checkbox" />
                            <label asp-for="Kvkk" class="checkbox-label">
                                <a href="#" target="_blank">KVKK</a> kapsamında kişisel verilerimin işlenmesini kabul ediyorum <span class="required">*</span>
                            </label>
                        </div>
                        <div class="error-message" id="kvkkError" style="display: none;">
                            <span>⚠</span> KVKK onayı gereklidir
                        </div>
                        <span asp-validation-for="Kvkk" class="text-danger"></span>
                    </div>

                    <button type="button" class="submit-btn" id="submitBtn">Hesap Oluştur</button>

                    <div class="login-link">
                        Zaten hesabınız var mı? <a asp-route="giris">Giriş Yap</a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Başvuru Formu Modal -->
<div class="modal fade" id="basvuruModal" tabindex="-1" aria-labelledby="basvuruModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header border-0 pb-0">
                <h5 class="modal-title fw-bold" id="basvuruModalLabel">Vekarer Başvuru Formu</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Kapat"></button>
            </div>
            <div class="modal-body pt-2">
                <p class="text-muted small mb-4">Referans kodunuz yoksa, aşağıdaki formu doldurarak başvuruda bulunabilirsiniz. Başvurunuz incelendikten sonra size dönüş yapılacaktır.</p>

                <form id="basvuruForm" enctype="multipart/form-data">
                    @Html.AntiForgeryToken()
                    <div class="row g-3">
                        <!-- Kişisel Bilgiler -->
                        <div class="col-12"><h6 class="text-primary border-bottom pb-2 mb-3">Kişisel Bilgiler</h6></div>
                        
                        <div class="col-md-6">
                            <label for="BasvuruAdSoyad" class="form-label small fw-bold">Ad Soyad <span class="text-danger">*</span></label>
                            <input type="text" class="form-control" id="BasvuruAdSoyad" name="AdSoyad" required placeholder="Adınız Soyadınız">
                        </div>
                        <div class="col-md-6">
                            <label for="BasvuruTelefon" class="form-label small fw-bold">Telefon <span class="text-danger">*</span></label>
                            <input type="tel" class="form-control" id="BasvuruTelefon" name="Telefon" required placeholder="(5XX) XXX XX XX" oninput="handleBasvuruPhoneInput(event)">
                        </div>
                        <div class="col-md-6">
                            <label for="BasvuruEmail" class="form-label small fw-bold">E-posta <span class="text-danger">*</span></label>
                            <input type="email" class="form-control" id="BasvuruEmail" name="Email" required placeholder="ornek@email.com">
                        </div>
                        <div class="col-md-6">
                             <!-- Spacer or additional field if needed -->
                        </div>

                        <!-- Konum ve Meslek -->
                         <div class="col-12 mt-4"><h6 class="text-primary border-bottom pb-2 mb-3">Konum ve Meslek</h6></div>

                        <div class="col-md-6">
                            <label for="BasvuruIl" class="form-label small fw-bold">İl <span class="text-danger">*</span></label>
                            <select class="form-select" id="BasvuruIl" name="Il" required>
                                <option value="">Seçiniz</option>
                                <option value="Adana">Adana</option>
                                <option value="Adıyaman">Adıyaman</option>
                                <option value="Afyonkarahisar">Afyonkarahisar</option>
                                <option value="Ağrı">Ağrı</option>
                                <option value="Aksaray">Aksaray</option>
                                <option value="Amasya">Amasya</option>
                                <option value="Ankara">Ankara</option>
                                <option value="Antalya">Antalya</option>
                                <option value="Ardahan">Ardahan</option>
                                <option value="Artvin">Artvin</option>
                                <option value="Aydın">Aydın</option>
                                <option value="Balıkesir">Balıkesir</option>
                                <option value="Bartın">Bartın</option>
                                <option value="Batman">Batman</option>
                                <option value="Bayburt">Bayburt</option>
                                <option value="Bilecik">Bilecik</option>
                                <option value="Bingöl">Bingöl</option>
                                <option value="Bitlis">Bitlis</option>
                                <option value="Bolu">Bolu</option>
                                <option value="Burdur">Burdur</option>
                                <option value="Bursa">Bursa</option>
                                <option value="Çanakkale">Çanakkale</option>
                                <option value="Çankırı">Çankırı</option>
                                <option value="Çorum">Çorum</option>
                                <option value="Denizli">Denizli</option>
                                <option value="Diyarbakır">Diyarbakır</option>
                                <option value="Düzce">Düzce</option>
                                <option value="Edirne">Edirne</option>
                                <option value="Elazığ">Elazığ</option>
                                <option value="Erzincan">Erzincan</option>
                                <option value="Erzurum">Erzurum</option>
                                <option value="Eskişehir">Eskişehir</option>
                                <option value="Gaziantep">Gaziantep</option>
                                <option value="Giresun">Giresun</option>
                                <option value="Gümüşhane">Gümüşhane</option>
                                <option value="Hakkari">Hakkari</option>
                                <option value="Hatay">Hatay</option>
                                <option value="Iğdır">Iğdır</option>
                                <option value="Isparta">Isparta</option>
                                <option value="İstanbul">İstanbul</option>
                                <option value="İzmir">İzmir</option>
                                <option value="Kahramanmaraş">Kahramanmaraş</option>
                                <option value="Karabük">Karabük</option>
                                <option value="Karaman">Karaman</option>
                                <option value="Kars">Kars</option>
                                <option value="Kastamonu">Kastamonu</option>
                                <option value="Kayseri">Kayseri</option>
                                <option value="Kırıkkale">Kırıkkale</option>
                                <option value="Kırklareli">Kırklareli</option>
                                <option value="Kırşehir">Kırşehir</option>
                                <option value="Kilis">Kilis</option>
                                <option value="Kocaeli">Kocaeli</option>
                                <option value="Konya">Konya</option>
                                <option value="Kütahya">Kütahya</option>
                                <option value="Malatya">Malatya</option>
                                <option value="Manisa">Manisa</option>
                                <option value="Mardin">Mardin</option>
                                <option value="Mersin">Mersin</option>
                                <option value="Muğla">Muğla</option>
                                <option value="Muş">Muş</option>
                                <option value="Nevşehir">Nevşehir</option>
                                <option value="Niğde">Niğde</option>
                                <option value="Ordu">Ordu</option>
                                <option value="Osmaniye">Osmaniye</option>
                                <option value="Rize">Rize</option>
                                <option value="Sakarya">Sakarya</option>
                                <option value="Samsun">Samsun</option>
                                <option value="Siirt">Siirt</option>
                                <option value="Sinop">Sinop</option>
                                <option value="Sivas">Sivas</option>
                                <option value="Şanlıurfa">Şanlıurfa</option>
                                <option value="Şırnak">Şırnak</option>
                                <option value="Tekirdağ">Tekirdağ</option>
                                <option value="Tokat">Tokat</option>
                                <option value="Trabzon">Trabzon</option>
                                <option value="Tunceli">Tunceli</option>
                                <option value="Uşak">Uşak</option>
                                <option value="Van">Van</option>
                                <option value="Yalova">Yalova</option>
                                <option value="Yozgat">Yozgat</option>
                                <option value="Zonguldak">Zonguldak</option>
                                <option value="Diğer">Diğer</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label for="BasvuruIlce" class="form-label small fw-bold">İlçe <span class="text-danger">*</span></label>
                            <input type="text" class="form-control" id="BasvuruIlce" name="Ilce" required placeholder="İlçe">
                        </div>
                        <div class="col-md-6">
                            <label for="BasvuruMeslek" class="form-label small fw-bold">Şu Anki Mesleğiniz <span class="text-danger">*</span></label>
                            <input type="text" class="form-control" id="BasvuruMeslek" name="Meslek" required placeholder="Mesleğiniz">
                        </div>
                        <div class="col-md-6">
                            <label for="BasvuruEgitim" class="form-label small fw-bold">Eğitim Durumu <span class="text-danger">*</span></label>
                            <select class="form-select" id="BasvuruEgitim" name="EgitimDurumu" required>
                                <option value="">Seçiniz</option>
                                <option value="İlkokul">İlkokul</option>
                                <option value="Ortaokul">Ortaokul</option>
                                <option value="Lise">Lise</option>
                                <option value="Ön Lisans">Ön Lisans</option>
                                <option value="Lisans">Lisans</option>
                                <option value="Yüksek Lisans">Yüksek Lisans</option>
                                <option value="Doktora">Doktora</option>
                            </select>
                        </div>

                        <!-- Tecrübe ve Beklenti -->
                        <div class="col-12 mt-4"><h6 class="text-primary border-bottom pb-2 mb-3">Tecrübe ve Beklenti</h6></div>

                        <div class="col-md-6">
                            <label for="BasvuruTecrube" class="form-label small fw-bold">Gayrimenkul Tecrübesi <span class="text-danger">*</span></label>
                            <select class="form-select" id="BasvuruTecrube" name="GayrimenkulTecrubesi" required>
                                <option value="">Seçiniz</option>
                                <option value="Yok">Yok</option>
                                <option value="0-2 Yıl">0-2 Yıl</option>
                                <option value="2-5 Yıl">2-5 Yıl</option>
                                <option value="5+ Yıl">5+ Yıl</option>
                            </select>
                        </div>
                         <div class="col-md-6">
                            <label for="BasvuruNereden" class="form-label small fw-bold">Bizi Nereden Duydunuz? <span class="text-danger">*</span></label>
                            <select class="form-select" id="BasvuruNereden" name="NeredenDuydunuz" required>
                                <option value="">Seçiniz</option>
                                <option value="Sosyal Medya">Sosyal Medya</option>
                                <option value="Arkadaş Tavsiyesi">Arkadaş Tavsiyesi</option>
                                <option value="İnternet Araması">İnternet Araması</option>
                                <option value="Reklamlar">Reklamlar</option>
                                <option value="Diğer">Diğer</option>
                            </select>
                        </div>

                        <div class="col-12">
                            <label for="BasvuruKendiniTanit" class="form-label small fw-bold">Kendinizi Tanıtın <span class="text-danger">*</span></label>
                            <textarea class="form-control" id="BasvuruKendiniTanit" name="KendiniziTanitin" rows="3" required placeholder="Kısaca kendinizden bahsedin..."></textarea>
                        </div>
                         <div class="col-12">
                            <label for="BasvuruBeklenti" class="form-label small fw-bold">Beklentiniz (Opsiyonel)</label>
                            <textarea class="form-control" id="BasvuruBeklenti" name="Beklentiniz" rows="2" placeholder="Vekarer'den beklentileriniz nelerdir?"></textarea>
                        </div>

                         <!-- Dosya ve Linkler -->
                        <div class="col-12 mt-4"><h6 class="text-primary border-bottom pb-2 mb-3">CV ve Sosyal Medya</h6></div>

                        <div class="col-md-6">
                            <label for="BasvuruCv" class="form-label small fw-bold">CV Yükle (PDF, Max 5MB) (Opsiyonel)</label>
                            <input type="file" class="form-control" id="BasvuruCv" name="CvDosyasi" accept=".pdf">
                            <div class="form-text small">Sadece PDF formatında dosya yükleyebilirsiniz.</div>
                        </div>
                        <div class="col-md-6">
                            <label for="BasvuruSosyal" class="form-label small fw-bold">LinkedIn / Sosyal Medya (Opsiyonel)</label>
                            <input type="url" class="form-control" id="BasvuruSosyal" name="SosyalMedyaLink" placeholder="https://...">
                        </div>

                        <div class="col-12 mt-3">
                            <div class="d-flex align-items-start">
                                <input class="form-check-input mt-1 me-2" type="checkbox" id="BasvuruKvkk" name="KvkkOnay" value="true" required style="width: 18px; height: 18px; flex-shrink: 0; cursor: pointer;">
                                <label class="form-check-label small text-muted" for="BasvuruKvkk" style="line-height: 1.6; padding-top: 1px; cursor: pointer;">
                                    <a href="#" target="_blank" class="text-decoration-underline">KVKK Aydınlatma Metni</a>'ni okudum, kişisel verilerimin işlenmesini onaylıyorum. <span class="text-danger">*</span>
                                </label>
                            </div>
                        </div>
                    </div>
                </form>
                <div id="basvuruAlert" class="alert mt-3" style="display:none;"></div>
            </div>
            <div class="modal-footer border-0">
                <button type="button" class="btn btn-light" data-bs-dismiss="modal">Kapat</button>
                <button type="button" class="btn btn-primary" id="btnBasvuruGonder">Başvuruyu Gönder</button>
            </div>
        </div>
    </div>
</div>

<!-- Success Modal -->
<div class="modal fade" id="basvuruSuccessModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-body text-center p-5">
                <div class="mb-4">
                    <svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="#28a745" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                        <polyline points="22 4 12 14.01 9 11.01"></polyline>
                    </svg>
                </div>
                <h3 class="mb-3">Başvurunuz Alındı!</h3>
                <p class="text-muted mb-4">Başvuru formunuz başarıyla bize ulaşmıştır. En kısa sürede sizinle iletişime geçeceğiz. İlginiz için teşekkür ederiz.</p>
                <button type="button" class="btn btn-primary px-5" data-bs-dismiss="modal">Tamam</button>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script src="~/js/register.js" asp-append-version="true"></script>
    <script>
        function handleBasvuruPhoneInput(e) {
            let value = e.target.value.replace(/\D/g, '');
            if (value.length > 10) value = value.slice(0, 10);

            if (value.length > 0) {
                if (value.length <= 3) {
                    value = '(' + value;
                } else if (value.length <= 6) {
                    value = '(' + value.slice(0, 3) + ') ' + value.slice(3);
                } else if (value.length <= 8) {
                    value = '(' + value.slice(0, 3) + ') ' + value.slice(3, 6) + ' ' + value.slice(6);
                } else {
                    value = '(' + value.slice(0, 3) + ') ' + value.slice(3, 6) + ' ' + value.slice(6, 8) + ' ' + value.slice(8);
                }
            }
            e.target.value = value;
        }

        $(document).ready(function() {
            $('#btnBasvuruGonder').click(function() {
                var form = $('#basvuruForm')[0];
                if (!form.checkValidity()) {
                    form.reportValidity();
                    return;
                }

                // KVKK Check
                if(!$('#BasvuruKvkk').is(':checked')) {
                     alert('Lütfen KVKK metnini onaylayınız.');
                     return;
                }

                var formData = new FormData(form);
                var btn = $(this);
                btn.prop('disabled', true).html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Gönderiliyor...');
                $('#basvuruAlert').hide().removeClass('alert-success alert-danger');

                $.ajax({
                    url: '/Basvuru/Submit',
                    type: 'POST',
                    data: formData,
                    processData: false,
                    contentType: false,
                    success: function(response) {
                        if (response.success) {
                            // Hide form modal
                            var basvuruModal = bootstrap.Modal.getInstance(document.getElementById('basvuruModal'));
                            basvuruModal.hide();
                            
                            // Reset form
                            form.reset();
                            
                            // Show success modal
                            var successModal = new bootstrap.Modal(document.getElementById('basvuruSuccessModal'));
                            successModal.show();
                        } else {
                            var errorMsg = response.message;
                            if(response.errors && response.errors.length > 0) {
                                errorMsg += '<ul>';
                                response.errors.forEach(function(err){ errorMsg += '<li>' + err + '</li>'; });
                                errorMsg += '</ul>';
                            }
                            $('#basvuruAlert').addClass('alert-danger').html(errorMsg).show();
                        }
                    },
                    error: function() {
                        $('#basvuruAlert').addClass('alert-danger').text('Bir hata oluştu. Lütfen tekrar deneyiniz.').show();
                    },
                    complete: function() {
                        btn.prop('disabled', false).text('Başvuruyu Gönder');
                    }
                });
            });
        });
    </script>
}